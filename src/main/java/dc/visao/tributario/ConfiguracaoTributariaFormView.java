package dc.visao.tributario;

import org.springframework.beans.factory.annotation.Autowired;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.ui.ComboBox;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.GridLayout;
import com.vaadin.ui.TabSheet;
import com.vaadin.ui.TextArea;
import com.vaadin.ui.TextField;
import com.vaadin.ui.VerticalLayout;

import dc.controller.tributario.ConfiguracaoTributariaFormController;
import dc.controller.tributario.GrupoTributarioFormController;
import dc.entidade.tributario.ConfiguracaoTributaria;
import dc.entidade.tributario.GrupoTributario;
import dc.entidade.tributario.OperacaoFiscal;
import dc.visao.framework.util.ComponentUtil;

@SuppressWarnings("serial")
public class ConfiguracaoTributariaFormView extends CustomComponent {

	@AutoGenerated
	private VerticalLayout mainLayout;

	@AutoGenerated
	private GridLayout fields;

	ConfiguracaoTributariaFormController controller;
	
	ConfiguracaoTributaria currentBean;

	private ComboBox cmbGrupoTributario;
	
	private ComboBox cmbOperacaoFiscal;
	
	@AutoGenerated
	private TabSheet subForms;
	
	public ConfiguracaoTributariaFormView(ConfiguracaoTributariaFormController controller) {
		this.controller = controller;
		buildMainLayout();
		setCompositionRoot(mainLayout);
	}

	@AutoGenerated
	private GridLayout buildFields() {
		// common part: create layout
		fields = new GridLayout(6, 3);
		fields.setImmediate(false);
		fields.setWidth("100.0%");
		fields.setHeight("-1px");
		fields.setMargin(false);
		fields.setSpacing(true);

		// calDataRequisicao

		cmbGrupoTributario = ComponentUtil.buildComboBox("Grupo Tributário");
		cmbOperacaoFiscal = ComponentUtil.buildComboBox("Operação Fiscal");
		
        montaGrupoTributario();
        montaOperacaoFiscal();
        fields.addComponent(cmbGrupoTributario,0,0,1,0);
        fields.addComponent(cmbOperacaoFiscal,2,0,3,0);
		return fields;
	}
	
	public void montaGrupoTributario(){
		try{
			for(GrupoTributario g : controller.trazerGrupos()){
				cmbGrupoTributario.addItem(g);
			}
		}catch(Exception e){
			e.printStackTrace();
		}
		
	}
	
	public void montaOperacaoFiscal(){
		try{
			for(OperacaoFiscal op : controller.trazerOperacoes()){
				cmbOperacaoFiscal.addItem(op);
			}
		}catch(Exception e){
			e.printStackTrace();
		}
		
	}

	@AutoGenerated
	private VerticalLayout buildMainLayout() {
		// common part: create layout
		mainLayout = new VerticalLayout();
		mainLayout.setImmediate(false);
		mainLayout.setSizeFull();
		mainLayout.setMargin(false);
		mainLayout.setSpacing(true);

		// top-level component properties
		setWidth("100.0%");
		setHeight("70.0%");

		// fields
		fields = buildFields();
		mainLayout.addComponent(fields);

		subForms = new TabSheet();
		subForms.setWidth("100.0%");
		subForms.setHeight("100.0%");
		subForms.setSizeFull();
		subForms.setImmediate(true);
		buildAbaICMS();
		buildAbaIPI();
		buildAbaPIS();
		buildAbaCofins();
		
		mainLayout.addComponent(subForms);
		mainLayout.setExpandRatio(subForms, 2);

		return mainLayout;
	}

	public VerticalLayout getMainLayout() {
		return mainLayout;
	}

	public ComboBox getCmbGrupoTributario() {
		return cmbGrupoTributario;
	}

	public void setCmbGrupoTributario(ComboBox cmbGrupoTributario) {
		this.cmbGrupoTributario = cmbGrupoTributario;
	}

	public ComboBox getCmbOperacaoFiscal() {
		return cmbOperacaoFiscal;
	}

	public void setCmbOperacaoFiscal(ComboBox cmbOperacaoFiscal) {
		this.cmbOperacaoFiscal = cmbOperacaoFiscal;
	}
	
	public void buildAbaICMS(){

		TabSheet abaICMS = buildICMSSubForm();
		GridLayout layout = new GridLayout(1,1);
		layout.setImmediate(false);
		layout.setWidth("100.0%");
		layout.setHeight("100.0%");
		layout.setMargin(true);
		layout.setSpacing(true);
		layout.setSizeFull();
		layout.addComponent(abaICMS);
		subForms.addTab(layout, "ICMS", null);
	}

	private TabSheet buildICMSSubForm() {
		// common part: create layout
		TabSheet sub = new TabSheet();
		sub.setWidth("100.0%");
		sub.setHeight("100.0%");
		sub.setSizeFull();
		sub.setImmediate(true);
		sub.addTab(null, "ICMS", null);
	    return sub;	
	}
	
	public void buildAbaIPI(){

		TabSheet abaICMS = buildIPISubForm();
		GridLayout layout = new GridLayout(1,1);
		layout.setImmediate(false);
		layout.setWidth("100.0%");
		layout.setHeight("100.0%");
		layout.setMargin(true);
		layout.setSpacing(true);
		layout.setSizeFull();
		layout.addComponent(abaICMS);
		subForms.addTab(layout, "ICMS", null);
	}

	private TabSheet buildIPISubForm() {
		// common part: create layout
		TabSheet sub = new TabSheet();
		sub.setWidth("100.0%");
		sub.setHeight("100.0%");
		sub.setSizeFull();
		sub.setImmediate(true);
		sub.addTab(null, "IPI", null);
	    return sub;	
	}
	
	public void buildAbaPIS(){

		TabSheet abaICMS = buildPISSubForm();
		GridLayout layout = new GridLayout(1,1);
		layout.setImmediate(false);
		layout.setWidth("100.0%");
		layout.setHeight("100.0%");
		layout.setMargin(true);
		layout.setSpacing(true);
		layout.setSizeFull();
		layout.addComponent(abaICMS);
		subForms.addTab(layout, "PIS", null);
	}

	private TabSheet buildPISSubForm() {
		// common part: create layout
		TabSheet sub = new TabSheet();
		sub.setWidth("100.0%");
		sub.setHeight("100.0%");
		sub.setSizeFull();
		sub.setImmediate(true);
		sub.addTab(null, "PIS", null);
	    return sub;	
	}
	
	public void buildAbaCofins(){

		TabSheet abaICMS = buildCofinsSubForm();
		GridLayout layout = new GridLayout(1,1);
		layout.setImmediate(false);
		layout.setWidth("100.0%");
		layout.setHeight("100.0%");
		layout.setMargin(true);
		layout.setSpacing(true);
		layout.setSizeFull();
		layout.addComponent(abaICMS);
		subForms.addTab(layout, "COFINS", null);
	}

	private TabSheet buildCofinsSubForm() {
		// common part: create layout
		TabSheet sub = new TabSheet();
		sub.setWidth("100.0%");
		sub.setHeight("100.0%");
		sub.setSizeFull();
		sub.setImmediate(true);
		sub.addTab(null, "COFINS", null);
	    return sub;	
	}

}
